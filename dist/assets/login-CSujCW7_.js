import{N as e,A as t}from"./notifications-CpdO2b2_.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";import"https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";class o{constructor(){this.currentForm="login",this.init()}async init(){try{console.log("üîê Inicializando p√°gina de login..."),e.init(),await t.init();if(t.currentUser)return console.log("‚úÖ Usuario ya autenticado, redirigiendo al dashboard..."),void this.redirectToDashboard();this.setupEventListeners(),console.log("‚úÖ P√°gina de login inicializada correctamente")}catch(o){console.error("‚ùå Error al inicializar p√°gina de login:",o),this.showError("Error al inicializar la aplicaci√≥n. Por favor, recarga la p√°gina.")}}setupEventListeners(){const e=document.getElementById("loginTabBtn"),t=document.getElementById("registerTabBtn");e&&e.addEventListener("click",()=>this.switchToLogin()),t&&t.addEventListener("click",()=>this.switchToRegister());const o=document.getElementById("loginForm"),r=document.getElementById("registerForm"),n=document.getElementById("googleLogin");o&&o.addEventListener("submit",e=>this.handleLogin(e)),r&&r.addEventListener("submit",e=>this.handleRegister(e)),n&&n.addEventListener("click",()=>this.handleGoogleLogin())}switchToLogin(){this.currentForm="login",document.getElementById("loginTabBtn").className="auth-tab-btn flex-1 px-4 py-2 font-semibold border-b-2 border-blue-500 text-blue-600 dark:text-blue-400",document.getElementById("registerTabBtn").className="auth-tab-btn flex-1 px-4 py-2 font-semibold border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",document.getElementById("loginForm").classList.remove("hidden"),document.getElementById("registerForm").classList.add("hidden")}switchToRegister(){this.currentForm="register",document.getElementById("registerTabBtn").className="auth-tab-btn flex-1 px-4 py-2 font-semibold border-b-2 border-green-500 text-green-600 dark:text-green-400",document.getElementById("loginTabBtn").className="auth-tab-btn flex-1 px-4 py-2 font-semibold border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",document.getElementById("registerForm").classList.remove("hidden"),document.getElementById("loginForm").classList.add("hidden")}async handleLogin(o){o.preventDefault();const r=document.getElementById("loginEmail").value,n=document.getElementById("loginPassword").value;if(r&&n)try{this.showLoading("Iniciando sesi√≥n...");const o=await t.signIn(r,n);o&&(console.log("‚úÖ Login exitoso:",o.email),e.show("¬°Bienvenido! Redirigiendo al dashboard...","success"),setTimeout(()=>{this.redirectToDashboard()},1500))}catch(s){console.error("‚ùå Error en login:",s),this.showError(this.getAuthErrorMessage(s.code))}else this.showError("Por favor, completa todos los campos")}async handleRegister(o){o.preventDefault();const r=document.getElementById("registerEmail").value,n=document.getElementById("registerPassword").value,s=document.getElementById("registerConfirmPassword").value;if(r&&n&&s)if(n===s)if(n.length<6)this.showError("La contrase√±a debe tener al menos 6 caracteres");else try{this.showLoading("Creando cuenta...");const o=await t.signUp(r,n);o&&(console.log("‚úÖ Registro exitoso:",o.email),e.show("¬°Cuenta creada exitosamente! Redirigiendo al dashboard...","success"),setTimeout(()=>{this.redirectToDashboard()},1500))}catch(i){console.error("‚ùå Error en registro:",i),this.showError(this.getAuthErrorMessage(i.code))}else this.showError("Las contrase√±as no coinciden");else this.showError("Por favor, completa todos los campos")}async handleGoogleLogin(){try{this.showLoading("Iniciando sesi√≥n con Google...");const o=await t.signInWithGoogle();o&&(console.log("‚úÖ Login con Google exitoso:",o.email),e.show("¬°Bienvenido! Redirigiendo al dashboard...","success"),setTimeout(()=>{this.redirectToDashboard()},1500))}catch(o){console.error("‚ùå Error en login con Google:",o),this.showError("Error al iniciar sesi√≥n con Google. Int√©ntalo de nuevo.")}}getAuthErrorMessage(e){return{"auth/user-not-found":"No existe una cuenta con este email","auth/wrong-password":"Contrase√±a incorrecta","auth/email-already-in-use":"Ya existe una cuenta con este email","auth/weak-password":"La contrase√±a es demasiado d√©bil","auth/invalid-email":"Email inv√°lido","auth/too-many-requests":"Demasiados intentos. Int√©ntalo m√°s tarde","auth/network-request-failed":"Error de conexi√≥n. Verifica tu internet","auth/popup-closed-by-user":"Se cancel√≥ el login con Google"}[e]||"Error de autenticaci√≥n. Int√©ntalo de nuevo."}showLoading(e){const t=document.createElement("div");t.id="loadingOverlay",t.className="fixed inset-0 bg-black/50 flex items-center justify-center z-50",t.innerHTML=`\n            <div class="bg-white dark:bg-gray-800 rounded-lg p-6 text-center">\n                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>\n                <p class="text-gray-700 dark:text-gray-300">${e}</p>\n            </div>\n        `,document.body.appendChild(t)}hideLoading(){const e=document.getElementById("loadingOverlay");e&&e.remove()}showError(t){this.hideLoading(),e.show(t,"error")}redirectToDashboard(){sessionStorage.setItem("authenticated","true"),window.location.href="/dashboard.html"}}document.addEventListener("DOMContentLoaded",()=>{new o});
